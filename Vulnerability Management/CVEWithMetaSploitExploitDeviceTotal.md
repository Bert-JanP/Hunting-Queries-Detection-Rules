# Vulnerabilities that have an exploit available in MetaSploit by device
----
## Defender XDR
```
let MetaSploitExploitsWithAssignedCVE = externaldata(cveid: string)[@"https://feeds.ecrimelabs.net/data/metasploit-cve"] with (format="txt", ignoreFirstRecord=True);
DeviceTvmSoftwareVulnerabilities
| where CveId in~ (MetaSploitExploitsWithAssignedCVE)
| summarize
     TotalVulnerabilities = dcount(CveId),
     Vulnerabilities = make_set(CveId)
     by DeviceName
| sort by TotalVulnerabilities
```
